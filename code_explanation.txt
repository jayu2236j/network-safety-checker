Code Explanation – Network Safety Checker

This document explains the key components of the Bash script.

1. Color Variables

ANSI escape codes are used to print colored output.
These help visually separate warnings, errors, and success messages.

2. Score System

The script begins with a default score of 10.
Risky configurations subtract points; safe configurations preserve the score.

3. Root Check

Most security operations require root access.
The script stops running if executed without sudo.

4. Logging

All output is logged to /var/log/network_safety_checker.log using the tee command.

5. Section Function

Each section uses a helper function to print a consistent, styled header.

6. Firewall Check

Detects whether UFW or firewalld is active.
Inactive firewall reduces the score.

7. Open Ports

Uses ss or netstat to show active listening ports, helping users identify unexpected services.

8. SSH Configuration

Reads /etc/ssh/sshd_config to detect risky options such as PermitRootLogin yes or password authentication.

9. Empty Password Users

Scans /etc/shadow for accounts with no password set, which is a severe vulnerability.

10. World-Writable Files

Searches /etc for files with world-writable permissions.

11. Package Updates

Checks for pending system updates using apt and warns if updates are available.

12. Fail2Ban

Detects whether Fail2Ban is installed and running for intrusion prevention.

13. Dangerous Services

Checks for deprecated protocols such as Telnet and FTP.

14. Home Directory Permissions

Evaluates whether user home directories have overly permissive settings.

15. Kernel Version Summary

Displays kernel information and package candidate versions.

16. Patch Summary

Runs an upgrade simulation and summarizes pending patches.

17. MITM / ARP Spoofing Detection

This analyzes the ARP table and checks if multiple MAC addresses claim to be the default gateway—
a strong signal of a Man-in-the-Middle (MITM) attack on public Wi-Fi.

18. Final Score

The script prints a final security score and suggests reviewing warnings.